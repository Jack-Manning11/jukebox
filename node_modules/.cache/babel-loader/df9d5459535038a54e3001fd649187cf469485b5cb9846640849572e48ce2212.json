{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\nconst useAuth = code => {\n  _s();\n  const [accessToken, setAccessToken] = useState();\n  const [refreshToken, setRefreshToken] = useState();\n  const [expiresIn, setExpiresIn] = useState();\n  useEffect(() => {\n    (async () => {\n      try {\n        const {\n          data: {\n            access_token,\n            refresh_token,\n            expires_in\n          }\n        } = await axios.post(`http://localhost:3001/login`, {\n          code\n        });\n        setAccessToken(access_token);\n        setRefreshToken(refresh_token);\n        setExpiresIn(expires_in);\n        window.history.pushState({}, null, '/');\n      } catch {\n        //window.location = '/';\n      }\n    })();\n  }, [code]);\n  useEffect(() => {\n    if (!refreshToken || !expiresIn) return;\n    const interval = setInterval(async () => {\n      try {\n        const {\n          data: {\n            access_token,\n            expires_in\n          }\n        } = await axios.post(`${process.env.REACT_APP_BASE_URL}/refresh`, {\n          refreshToken\n        });\n        setAccessToken(access_token);\n        setExpiresIn(expires_in);\n      } catch {\n        window.location = '/';\n      }\n    }, (expiresIn - 60) * 1000);\n    return () => clearInterval(interval);\n  }, [refreshToken, expiresIn]);\n  return accessToken;\n};\n_s(useAuth, \"E9KOao32uIhQ/xJLaKV8nLvpvcw=\");\nexport default useAuth;","map":{"version":3,"names":["useState","useEffect","axios","useAuth","code","_s","accessToken","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","data","access_token","refresh_token","expires_in","post","window","history","pushState","interval","setInterval","process","env","REACT_APP_BASE_URL","location","clearInterval"],"sources":["/Users/jackmanning/Downloads/FuckupTesting/client/src/hooks/useAuth.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nconst useAuth = (code) => {\n    const [accessToken, setAccessToken] = useState();\n    const [refreshToken, setRefreshToken] = useState();\n    const [expiresIn, setExpiresIn] = useState();\n\n    useEffect(() => {\n        (async () => {\n            try {\n                const {\n                    data: { access_token, refresh_token, expires_in },\n                } = await axios.post(`http://localhost:3001/login`, {\n                    code,\n                });\n                setAccessToken(access_token);\n                setRefreshToken(refresh_token);\n                setExpiresIn(expires_in);\n                window.history.pushState({}, null, '/');\n            } catch {\n                //window.location = '/';\n            }\n        })();\n    }, [code]);\n\n    useEffect(() => {\n        if(!refreshToken || !expiresIn) return;\n        const interval = setInterval(async () => {\n            try {\n                const {\n                    data: { access_token, expires_in },\n                } = await axios.post(`${process.env.REACT_APP_BASE_URL}/refresh`, {\n                    refreshToken,\n                });\n                setAccessToken(access_token);\n                setExpiresIn(expires_in);\n            } catch {\n                window.location = '/';\n            }\n        }, (expiresIn - 60) * 1000);\n\n        return () => clearInterval(interval);\n    }, [refreshToken, expiresIn]);\n\n    return accessToken;\n};\n\nexport default useAuth;"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAC3C,OAAOC,KAAK,MAAM,OAAO;AAEzB,MAAMC,OAAO,GAAIC,IAAI,IAAK;EAAAC,EAAA;EACtB,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAGP,QAAQ,CAAC,CAAC;EAChD,MAAM,CAACQ,YAAY,EAAEC,eAAe,CAAC,GAAGT,QAAQ,CAAC,CAAC;EAClD,MAAM,CAACU,SAAS,EAAEC,YAAY,CAAC,GAAGX,QAAQ,CAAC,CAAC;EAE5CC,SAAS,CAAC,MAAM;IACZ,CAAC,YAAY;MACT,IAAI;QACA,MAAM;UACFW,IAAI,EAAE;YAAEC,YAAY;YAAEC,aAAa;YAAEC;UAAW;QACpD,CAAC,GAAG,MAAMb,KAAK,CAACc,IAAI,CAAE,6BAA4B,EAAE;UAChDZ;QACJ,CAAC,CAAC;QACFG,cAAc,CAACM,YAAY,CAAC;QAC5BJ,eAAe,CAACK,aAAa,CAAC;QAC9BH,YAAY,CAACI,UAAU,CAAC;QACxBE,MAAM,CAACC,OAAO,CAACC,SAAS,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,GAAG,CAAC;MAC3C,CAAC,CAAC,MAAM;QACJ;MAAA;IAER,CAAC,EAAE,CAAC;EACR,CAAC,EAAE,CAACf,IAAI,CAAC,CAAC;EAEVH,SAAS,CAAC,MAAM;IACZ,IAAG,CAACO,YAAY,IAAI,CAACE,SAAS,EAAE;IAChC,MAAMU,QAAQ,GAAGC,WAAW,CAAC,YAAY;MACrC,IAAI;QACA,MAAM;UACFT,IAAI,EAAE;YAAEC,YAAY;YAAEE;UAAW;QACrC,CAAC,GAAG,MAAMb,KAAK,CAACc,IAAI,CAAE,GAAEM,OAAO,CAACC,GAAG,CAACC,kBAAmB,UAAS,EAAE;UAC9DhB;QACJ,CAAC,CAAC;QACFD,cAAc,CAACM,YAAY,CAAC;QAC5BF,YAAY,CAACI,UAAU,CAAC;MAC5B,CAAC,CAAC,MAAM;QACJE,MAAM,CAACQ,QAAQ,GAAG,GAAG;MACzB;IACJ,CAAC,EAAE,CAACf,SAAS,GAAG,EAAE,IAAI,IAAI,CAAC;IAE3B,OAAO,MAAMgB,aAAa,CAACN,QAAQ,CAAC;EACxC,CAAC,EAAE,CAACZ,YAAY,EAAEE,SAAS,CAAC,CAAC;EAE7B,OAAOJ,WAAW;AACtB,CAAC;AAACD,EAAA,CA3CIF,OAAO;AA6Cb,eAAeA,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}